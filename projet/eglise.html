<!DOCTYPE html>
<html class="no-js">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- <meta name="viewport" content="width=device-width"> -->
  <title>LEPAGE STUDIO - projet église de Larchant</title>
  <link href="../css/booststrap.min.css" rel="stylesheet" crossorigin="anonymous">
  <link rel="stylesheet" href="../css/cch1nog.css">
  <link rel="stylesheet" type="text/css" href="../css/base.css" />

  <script src="https://cdnjs.cloudflare.com/ajax/libs/bodymovin/5.6.6/lottie.min.js"></script>
  <script src="https://s3-us-west-2.amazonaws.com/s.cdpn.io/35984/ScrollLottie.js"></script>
  <link rel="stylesheet" href="../style2.css" />

</head>

<body class="eglise">
  <main>
    <nav class="navbar fixed-top navbar-expand-lg invert">
      <div class="container-fluid">
        <a class="navbar-brand" href="#">
          <img src="../img/lepage-studio-logo.svg">
        </a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav"
          aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse navbar-text" id="navbarNav">
          <ul class="navbar-nav">
            <li class="nav-item">
              <a class="nav-link active" aria-current="page" href="#">Home</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="../next.html">Projets</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="#">Contact</a>
            </li>
            <li class="nav-item">
              <a class="nav-link disabled" aria-disabled="true">About</a>
            </li>
          </ul>
        </div>
      </div>
    </nav>

    <div class="container black fixed-bottom secondnav">
      <div class="row">
        <a href="../home.html" class="col text-center align-middle ">
          Home
        </a>
        <a href="../next.html" class="col text-center align-middle ">
          Work
        </a>
        <a href="#" class="col text-center align-middle ">
          About
        </a>
      </div>
    </div>

    <div class="layout">
      <div class="container">

        <!-- SECTION HOME -->


        <section class="enter row d-flex">

          <div class=" contentTitre absoluteTop">
            <p class="info" id="date"></p>
            <h1 id="TitrePro" class=""></h1>

            <p class="info" id="key"></p>
          </div>

          <div class="col-md-6 col-sm-12 titre">

          </div>
          <div class="col-md-6 col-sm-12 imgIntro">
            <img src="../img/eglise/larchant-mockup.jpg" class="imgChurch imgChurch-large">
            <img src="../img/introchurch-small.jpg" class="imgChurch imgChurh-small">
            <p class="txtChurch" id="intro"></p>
          </div>
        </section>

        <!-- SECTION LOTTIE 360 -->
        <section class="row d-flex church360">
          <div class="col-4">
            <p class="txtchurch360 " id="txt1">
            </p>
          </div>
          <div class="col-8 window360">
            <div id="animationWindow">
            </div>
            <!-- <lottie-player id="churchOUT" src="../assets/churchOUT/lottie/data.json" ></lottie-player> -->
          </div>
        </section>
        <section class="row justify-content-center">
          <div class="col-8 align-self-center ">
            <p class="invent inventTop invert upMouv2" id="txt2">
            </p>
          </div>
        </section>
        <!-- VIDEO SECTION -->
        <section class="videoSection row d-flex">
          <div class="col-sm-12">
          </div>
          <div class="col-sm-12 ">
            <video id="myVideo" loop="">
              <source src="../img/eglise/timelapseChurch.mp4" type="video/mp4">
            </video>
            <div class="btnbox">
              <button onclick="playVid()" type="button" class="playBTN">
                <img src="../img/player/play.svg">
              </button>
              <button onclick="pauseVid()" type="button" class="playBTN">
                <img src="../img/player/pause.svg"></button>
            </div>
          </div>
        </section>

        <section class="row justify-content-center">
          <div class="col-4 align-self-center ">
            <p class="invent inventTop invert invent-small" id="txt3">

            </p>
          </div>
        </section>
        <!-- section de la mosaique IA  -->
      </div>
      <section class=" Mtextbox ">
        <div class="gallery-wrap">
          <div class="gallery gallery--bento" id="gallery-8">
            <div class="gallery__item" style="background-image:url(../img/eglise/gravure06.jpg)"></div>
            <div class="gallery__item" style="background-image:url(../img/eglise/wide-angle-church.jpg)"></div>
            <div class="gallery__item" style="background-image:url(../img/eglise/eglise-IA-1.jpg)"></div>
            <div class="gallery__item" style="background-image:url(../img/eglise/gravure03.jpg)"></div>
            <div class="gallery__item" style="background-image:url(../img/eglise/gravure04.jpg)"></div>
            <div class="gallery__item" style="background-image:url(../img/eglise/gravure05.jpg)"></div>
            <div class="gallery__item" style="background-image:url(../img/eglise/gravure01.jpg)"></div>
            <div class="gallery__item" style="background-image:url(../img/eglise/gravure09.jpg)"></div>
            <div class="caption" id="txt4"></div>
          </div>
        </div>

      </section>

      <div class="container">


        <section class="row justify-content-center ">
          <div class="col-8 align-self-center ">
            <p class="invent  invert upMouv" id="txt5">

            </p>
          </div>
        </section>

      </div>
      <section class="secframe row">
        <iframe id="inlineFrameExample" class="col-sm-12" src="https://aurelien-lepage.com/saint/eglise.html">
        </iframe>

      </section>

      <div class="container">

        <section class="row justify-content-center">
          <div class="col-8 align-self-center ">
            <p class="invent mbottom invert " id="txt6">
            </p>
          </div>
        </section>
      </div>




    </div>
  </main>
  <script src="../js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>

  <script src="../js/gsap.min.js"></script>
  <script src="../js/Flip.min.js"></script>
  <script src="../js/ScrollTrigger.min.js"></script>
  <script src="../js/lenis.min.js"></script>
  <script src="../js/imagesloaded.pkgd.min.js"></script>



  <script>

    var vid = document.getElementById("myVideo");

    function playVid() {
      vid.play();

    }

    function pauseVid() {
      vid.pause();
    }

  </script>

  <script>

    ScrollLottie({
      target: '#animationWindow',
      path: '../assets/churchOUT/lottie/data.json',
      duration: 4,
      speed: 'medium'
    });

  </script>


  <script type="module">
    // Import the necessary function for preloading images
    import { preloadImages } from '../js/utils.js';

    // Define a variable that will store the Lenis smooth scrolling object
    let lenis;

    // Function to initialize Lenis for smooth scrolling
    const initSmoothScrolling = () => {
      // Instantiate the Lenis object with specified properties
      lenis = new Lenis({
        lerp: 0.1, // Lower values create a smoother scroll effect
        smoothWheel: false // Enables smooth scrolling for mouse wheel events
      });

      // Update ScrollTrigger each time the user scrolls
      lenis.on('scroll', () => ScrollTrigger.update());

      // Define a function to run at each animation frame
      const scrollFn = (time) => {
        lenis.raf(time); // Run Lenis' requestAnimationFrame method
        requestAnimationFrame(scrollFn); // Recursively call scrollFn on each frame
      };
      // Start the animation frame loop
      requestAnimationFrame(scrollFn);
    };

    // Function to trigger Flip animations when scrolling
    const triggerFlipOnScroll = (galleryEl, options) => {
      // Default settings for Flip and ScrollTrigger
      let settings = {
        flip: {
          absoluteOnLeave: false,
          absolute: false,
          scale: true,
          simple: true,
          //...
        },
        scrollTrigger: {
          start: 'center center',
          end: '+=300%',
        },
        stagger: 0
      };

      // Merge default settings with options provided when calling the function
      settings = Object.assign({}, settings, options);

      // Select elements within the gallery that will be animated
      const galleryCaption = galleryEl.querySelector('.caption');
      const galleryItems = galleryEl.querySelectorAll('.gallery__item');
      const galleryItemsInner = [...galleryItems].map(item => item.children.length > 0 ? [...item.children] : []).flat();

      // Temporarily add the final class to capture the final state
      galleryEl.classList.add('gallery--switch');
      const flipstate = Flip.getState([galleryItems, galleryCaption], { props: 'filter, opacity' });

      // Remove the final class to revert to the initial state
      galleryEl.classList.remove('gallery--switch');

      // Create the Flip animation timeline
      const tl = Flip.to(flipstate, {
        ease: 'none',
        absoluteOnLeave: settings.flip.absoluteOnLeave,
        absolute: settings.flip.absolute,
        scale: settings.flip.scale,
        simple: settings.flip.simple,
        scrollTrigger: {
          trigger: galleryEl,
          start: settings.scrollTrigger.start,
          end: settings.scrollTrigger.end,
          pin: galleryEl.parentNode,
          scrub: true,
        },
        stagger: settings.stagger
      });

      gsap.registerPlugin(ScrollTrigger);
      let tl10 = gsap.timeline({
        scrollTrigger: {
          trigger: ".upMouv",
          start: "bottom bottom",
          end: "center center",
          // pin: true,
          scrub: 1,
          // markers: true,

        }
      })
      tl10.from(".upMouv", {
        y: -200,
        opacity: 0,
        duration: 5,
        ease: 2,
      })
      tl10.to(".upMouv", {
        y: 0,
        opacity: 1,

      });

      gsap.registerPlugin(ScrollTrigger);
      let tl11 = gsap.timeline({
        scrollTrigger: {
          trigger: ".upMouv2",
          start: "bottom bottom",
          end: "center center",
          scrub: 1,
        }
      })
      tl11.from(".upMouv2", {
        x: "+=200",
        opacity: 0,
        duration: 5,
        ease: 1,
      })
      tl11.to(".upMouv2", {
        x: 0,
        opacity: 1,
      });



      // If there are inner elements in the gallery items, animate them too
      if (galleryItemsInner.length) {
        tl.fromTo(galleryItemsInner, {
          scale: 2
        }, {
          scale: 1,
          scrollTrigger: {
            trigger: galleryEl,
            start: settings.scrollTrigger.start,
            end: settings.scrollTrigger.end,
            scrub: true,
          },
        }, 0)
      }
    };

    // Function to apply scroll-triggered animations to various galleries
    // Apply scroll-triggered animations to each gallery with specific settings
    const scroll = () => {
      // Define the gallery IDs and their options
      const galleries = [
        // { id: '#gallery-1', options: { flip: { absoluteOnLeave: true, scale: false } } },
        // { id: '#gallery-2' },
        // { id: '#gallery-3', options: { flip: { absolute: true, scale: false }, scrollTrigger: { start: 'center center', end: '+=900%' }, stagger: 0.05 } },
        // { id: '#gallery-4' },
        // { id: '#gallery-5' },
        // { id: '#gallery-6' },
        // { id: '#gallery-7' },
        { id: '#gallery-8', options: { flip: { scale: false } } },

        // { id: '#gallery-9' },
      ];

      // Loop through the galleries and apply the scroll-triggered animations
      galleries.forEach(gallery => {
        const galleryElement = document.querySelector(gallery.id);
        triggerFlipOnScroll(galleryElement, gallery.options);
      });
    }

    // Preload images, initialize smooth scrolling, apply scroll-triggered animations, and remove loading class from body

    gsap.registerPlugin(ScrollTrigger);
    let tl = gsap.timeline({
      scrollTrigger: {
        trigger: ".imgChurch",
        start: "top 50vh",
        end: "center 50vh ",
        scrub: 1,
        // pin:true,
        // markers: true,
      }
    });
    tl.to(".imgChurch", {
      x: "-50vw",
      y: "50vh",
      ease: 1,
      duration: 2,

    })
      .to(".imgChurch", {
        ease: 1,
        scale: 2,
        duration: 2,

      });


    gsap.registerPlugin(ScrollTrigger);
    let tl2 = gsap.timeline({
      scrollTrigger: {
        trigger: ".imgChurch",
        start: "top -100px",

        scrub: 1,
        // marker: true,
      }
    });
    tl2.to(".txtChurch", {
      y: "-100vh",
      duration: 1,
      ease: 1,
    });





    preloadImages('.gallery__item').then(() => {
      initSmoothScrolling();
      scroll();
      document.body.classList.remove('loading');
    });
  </script>




  <script>
    // Fonction pour charger et mettre à jour le contenu depuis le fichier JSON
    async function chargerContenuDepuisJSON() {
      try {
        // Charger le fichier JSON
        const response = await fetch('../assets/content.json');
        const data = await response.json();

        // Mettre à jour les éléments HTML avec les données du fichier JSON
        document.getElementById('TitrePro').innerHTML = data.eglise.titre;
        document.getElementById('key').textContent = data.eglise.key;
        document.getElementById('date').textContent = data.eglise.date;
        document.getElementById('intro').textContent = data.eglise.intro;
        document.getElementById('txt1').textContent = data.eglise.txt1;
        document.getElementById('txt2').innerHTML = '<span>&NonBreakingSpace;' + data.eglise.txt2Span + '&NonBreakingSpace;</span>&NonBreakingSpace;' + data.eglise.txt2;
        document.getElementById('txt3').textContent = data.eglise.txt3;
        document.getElementById('txt4').innerHTML = data.eglise.txt4;
        document.getElementById('txt5').innerHTML = data.eglise.txt5;
        document.getElementById('txt6').innerHTML = '<span>&NonBreakingSpace;' + data.eglise.txt6Span + '&NonBreakingSpace;</span>' + '<br>' + data.eglise.txt6;
      } catch (error) {
        console.error('Erreur lors du chargement du contenu JSON :', error);
      }
    }

    // Appeler la fonction pour charger le contenu au chargement de la page
    chargerContenuDepuisJSON();
  </script>



</body>

</html>

<!-- 
animation on scroll 

https://tympanus.net/Development/OnScrollFilter/ 

aniamte text
https://tympanus.net/Development/OnScrollTypographyAnimations/index.html

https://tympanus.net/Development/OnScrollTypographyAnimations/index2.html
-->